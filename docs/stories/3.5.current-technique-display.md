# Story 3.5: Current Technique Display

**Status:** Done  
**Epic:** 3 - Passage Generation & Core Execution  
**Story Number:** 3.5  

---

## Story

**As a** user,  
**I want** voir l'attaque et la technique en cours affichées en grand,  
**so that** je peux facilement lire ce que je dois exécuter même à distance.

---

## Acceptance Criteria

1. L'attaque et la technique en cours sont affichées de manière très visible au centre de l'écran
2. Le texte est très grand (minimum 48px sur mobile, plus grand sur desktop)
3. L'attaque et la technique sont clairement séparées visuellement
4. Le contraste est élevé pour une lisibilité maximale
5. L'affichage se met à jour automatiquement quand une nouvelle technique est annoncée
6. La transition entre techniques est fluide (fade in/out ou slide)
7. Le design est épuré sans distractions autour du texte principal

---

## Tasks / Subtasks

- [ ] **Task 1: Create Current Technique Display Section** (AC: 1, 7)
  - [ ] Créer la section pour afficher l'attaque et la technique en cours
  - [ ] Positionner au centre de l'écran
  - [ ] Design épuré sans distractions
  - [ ] Intégrer dans PassageComponent template

- [ ] **Task 2: Implement Large Text Display** (AC: 2, 4)
  - [ ] Afficher l'attaque et la technique avec texte très grand
  - [ ] Minimum 48px sur mobile, plus grand sur desktop (64px+)
  - [ ] Contraste élevé (couleurs claires/sombres selon thème)
  - [ ] Styles CSS appropriés (font-size, font-weight, color)

- [ ] **Task 3: Separate Attack and Technique Visually** (AC: 3)
  - [ ] Séparer clairement l'affichage de l'attaque et de la technique
  - [ ] Utiliser des lignes séparées, espacement, ou séparateur visuel
  - [ ] Hiérarchie visuelle claire (attaque en haut, technique en bas, ou côte à côte)

- [ ] **Task 4: Integrate with PassageService** (AC: 5)
  - [ ] Injecter PassageService dans PassageComponent
  - [ ] Récupérer la technique actuelle via PassageService.getCurrentTechnique()
  - [ ] Écouter les changements d'état pour mettre à jour l'affichage
  - [ ] Afficher l'attaque et la technique depuis l'objet Technique

- [ ] **Task 5: Implement Smooth Transitions** (AC: 6)
  - [ ] Utiliser Angular Animations pour transitions fluides
  - [ ] Implémenter fade in/out ou slide transition
  - [ ] Animation lors du changement de technique
  - [ ] Durée d'animation appropriée (300-500ms)

- [ ] **Task 6: Handle Empty/No Technique State** (AC: 5)
  - [ ] Gérer le cas où aucune technique n'est en cours
  - [ ] Afficher un message approprié ou laisser vide
  - [ ] Éviter les erreurs si currentTechnique est null

- [ ] **Task 7: Style Display for Distance Viewing** (AC: 2, 4, 7)
  - [ ] Styles optimisés pour visibilité à distance (mobile debout)
  - [ ] Espacement approprié entre attaque et technique
  - [ ] Design épuré et centré
  - [ ] Responsive design (mobile et desktop)

- [ ] **Task 8: Create Unit Tests** (AC: 1-7)
  - [ ] Tester l'affichage de l'attaque et de la technique
  - [ ] Tester la taille du texte
  - [ ] Tester la séparation visuelle
  - [ ] Tester la mise à jour automatique
  - [ ] Tester les transitions
  - [ ] Tester l'intégration avec PassageService

---

## Dev Notes

### Previous Story Insights

**Source:** Story 3.4 - Countdown Visual Display
- PassageComponent structure en place
- PassageService intégré
- Angular Animations configuré

**Source:** Story 3.2 - Passage State Management
- PassageService.getCurrentTechnique() disponible
- Technique model avec attaque, technique, position

### Technical Context

**Source:** [architecture/components.md](../../architecture/components.md)

**PassageComponent:**
- **Location:** `src/app/pages/passage/passage.ts`, `passage.html`, `passage.scss`
- **Dependencies:** PassageService pour technique actuelle

**Technique Model:**
```typescript
interface Technique {
  attack: string;
  technique: string;
  position: string;
  order: number;
}
```

**Display Structure:**
- Attaque et technique affichées séparément
- Hiérarchie: Attaque en haut (plus petit), Technique en bas (plus grand)
- Ou: Attaque et technique côte à côte avec séparateur

**Angular Animations:**
- Utiliser fadeIn/fadeOut ou slideIn/slideOut
- Transition lors du changement de technique
- Déjà configuré dans Story 3.4

### Implementation Details

**Template Structure:**
```html
<div class="current-technique" [@techniqueTransition]="transitionState">
  <div class="attack" *ngIf="currentTechnique">
    {{ currentTechnique.attack }}
  </div>
  <div class="technique" *ngIf="currentTechnique">
    {{ currentTechnique.technique }}
  </div>
</div>
```

**Component Logic:**
```typescript
currentTechnique: Technique | null = null;

ngOnInit() {
  this.subscriptions.add(
    this.passageService.getPassageState().subscribe(state => {
      this.currentTechnique = this.passageService.getCurrentTechnique();
      this.triggerTransition();
    })
  );
}
```

**Styles CSS:**
```scss
.current-technique {
  text-align: center;
  padding: 2rem;
  
  .attack {
    font-size: 2rem; // 32px
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--text-secondary);
  }
  
  .technique {
    font-size: 3rem; // 48px mobile, 4rem (64px) desktop
    font-weight: bold;
    color: var(--text-primary);
  }
}

@media (min-width: 768px) {
  .current-technique .technique {
    font-size: 4rem; // 64px desktop
  }
}
```

**Animation:**
```typescript
animations: [
  trigger('techniqueTransition', [
    transition('* => *', [
      style({ opacity: 0, transform: 'translateY(10px)' }),
      animate('400ms ease-out', style({ opacity: 1, transform: 'translateY(0)' }))
    ])
  ])
]
```

---

## Dependencies

- ✅ Story 3.4 complétée (PassageComponent structure, Angular Animations)
- ✅ Story 3.2 complétée (PassageService.getCurrentTechnique())
- ✅ Technique model défini (attaque, technique, position)
- ✅ PassageService intégré dans PassageComponent

---

## Testing Checklist

- [ ] Test: Attaque et technique affichées au centre de l'écran
- [ ] Test: Texte très grand (minimum 48px mobile, plus sur desktop)
- [ ] Test: Attaque et technique séparées visuellement
- [ ] Test: Contraste élevé (lisibilité)
- [ ] Test: Mise à jour automatique quand nouvelle technique annoncée
- [ ] Test: Transition fluide (fade/slide)
- [ ] Test: Design épuré sans distractions
- [ ] Test: Intégration avec PassageService
- [ ] Test: Gestion état vide (pas de technique)

---

## Definition of Done

- ✅ Tous les Acceptance Criteria sont remplis
- ✅ Code compile sans erreurs
- ✅ Tests unitaires passent (couverture minimale 70%)
- ✅ Affichage très visible et lisible
- ✅ Transitions fluides fonctionnent
- ✅ Design épuré et centré
- ✅ Intégration avec PassageService fonctionne
- ✅ Code review effectué
- ✅ Documentation du code (JSDoc) ajoutée

---
