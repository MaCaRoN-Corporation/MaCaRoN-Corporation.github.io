.home-page {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-md);
  position: relative;
  overflow: hidden;
  height: 100%;
  width: 100%;

  // Sur mobile : padding symétrique pour centrer correctement
  @media (max-width: 767px) {
    padding: var(--spacing-sm) var(--spacing-md); // Padding symétrique horizontal
    box-sizing: border-box;
  }

  @media (min-width: 768px) {
    padding: var(--spacing-lg);
    box-sizing: border-box;
  }

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(245, 241, 232, 0.05) 0%, rgba(240, 235, 225, 0.03) 100%);
    pointer-events: none;
    z-index: 0;
  }

  // Overlay adapté pour le thème sombre (voile léger pour améliorer la lisibilité)
  .appearance-sombre &::before {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.15) 0%, rgba(0, 0, 0, 0.1) 100%);
  }
}

.home-content {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xl);
  width: 100%;
  max-width: 1200px;
  position: relative;
  z-index: 1;
  height: 100%;
  box-sizing: border-box;

  flex-direction: column;

  // Sur mobile : titre en haut, reste du contenu espacé pour occuper toute la hauteur
  @media (max-width: 767px) {
    justify-content: flex-start; // Titre en haut
    align-items: center;
    padding-top: var(--spacing-sm); // Espacement sous la bannière
    gap: 0; // Pas de gap, géré individuellement
    height: 100%; // Prend toute la hauteur disponible
    min-height: 100vh; // Minimum la hauteur de la vue
  }

  @media (min-width: 768px) {
    flex-direction: row;
    align-items: stretch;
    max-width: 95%;
    gap: var(--spacing-xl);
    padding: 0 var(--spacing-lg);
    max-height: 100%;
  }

  @media (min-width: 1024px) {
    max-width: 98%;
    gap: calc(var(--spacing-xl) * 1.5);
  }

  @media (min-width: 1440px) {
    max-width: 1600px;
    gap: calc(var(--spacing-xl) * 2);
  }
}

.main-actions {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-lg);
  flex-shrink: 0;
  flex: 0 1 auto;

  // Sur mobile : espacer les éléments pour occuper toute la hauteur disponible
  @media (max-width: 767px) {
    flex: 1; // Prend l'espace restant
    justify-content: space-between; // Espacement maximum pour occuper toute la hauteur
    align-items: center; // Centre horizontalement
    width: 100%;
    gap: var(--spacing-sm); // Espacement réduit entre carrousel et boutons
    min-height: 0; // Permet au flex de fonctionner correctement
    padding: var(--spacing-md) 0; // Padding vertical pour aération
  }

  @media (min-width: 768px) {
    // Sur PC : gestion intelligente de l'espace pour occuper la même hauteur que le panel de configuration
    flex: 0 1 400px;
    height: 100%; // Prend toute la hauteur disponible (même que config-panel grâce à align-items: stretch)
    justify-content: space-between; // Espacement intelligent entre titre, carrousel et bouton
    align-items: center;
    gap: var(--spacing-md); // Espacement réduit pour mieux distribuer l'espace
    min-height: 0; // Permet au flex de fonctionner correctement
    padding: var(--spacing-sm) 0; // Padding vertical minimal
  }

  @media (min-width: 1024px) {
    flex: 0 1 450px;
  }

  @media (min-width: 1440px) {
    flex: 0 1 500px;
  }
}

// Titre principal SEO
.page-title {
  font-family: var(--font-family-primary);
  font-weight: var(--font-weight-medium); // Réduit de bold à medium
  text-align: center;
  margin: 0 auto;
  padding: 0;
  line-height: 1.4;

  // Mobile : centré sur la page, glassmorphism avec même effet
  @media (max-width: 767px) {
    font-size: 0.95rem; // Réduit de 1.4rem
    // Centrage horizontal : marges auto et largeur fixe
    margin-left: auto; // Centrage horizontal
    margin-right: auto; // Centrage horizontal
    margin-top: 0;
    margin-bottom: var(--spacing-md); // Espacement avec le contenu en dessous
    // Largeur agrandie sur mobile, en tenant compte du padding du parent (var(--spacing-md) = 1.5rem de chaque côté)
    // Pour éviter le dépassement, on utilise calc pour soustraire le padding du parent
    width: calc(95vw - var(--spacing-md) * 2); // 95vw moins le padding horizontal du parent
    max-width: none;
    flex-shrink: 0; // Ne pas rétrécir, taille fixe
    display: block; // Assure le centrage avec margin auto
    align-self: center; // Force le centrage dans le conteneur flex parent
    padding: var(--spacing-xs) var(--spacing-md); // Padding pour le glassmorphism
    color: var(--color-text-secondary); // Couleur suit le thème sur mobile
    // Glassmorphism original : même effet que sur PC
    backdrop-filter: blur(16px) saturate(200%) brightness(1.1);
    -webkit-backdrop-filter: blur(16px) saturate(200%) brightness(1.1);

    // Renforcement du backdrop-filter pour le mode clair
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      backdrop-filter: blur(20px) saturate(250%) brightness(1.15);
      -webkit-backdrop-filter: blur(20px) saturate(250%) brightness(1.15);
    }

    // Border-radius asymétrique pour une forme plus organique et originale
    border-radius: 20px 8px 20px 8px; // Coins alternés pour un effet unique
    box-sizing: border-box;
    position: relative;
    overflow: hidden;

    // Effet de brillance animé en arrière-plan
    &::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg,
          transparent 30%,
          rgba(255, 255, 255, 0.15) 50%,
          transparent 70%);
      animation: shimmer 8s infinite;
      pointer-events: none;
      z-index: 0;
    }

    // Le texte doit être au-dessus de l'effet de brillance
    >* {
      position: relative;
      z-index: 1;
    }

    // Adaptation pour le thème clair (explicite) - fond assombri pour meilleur contraste
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      background: linear-gradient(135deg,
          rgba(240, 235, 225, 0.9) 0%,
          rgba(235, 230, 220, 0.85) 50%,
          rgba(240, 235, 225, 0.9) 100%);
      border: none; // Pas de bordure pour le glassmorphism
      box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.35), // Ombre très prononcée
        0 6px 20px rgba(0, 0, 0, 0.3),
        0 2px 8px rgba(0, 0, 0, 0.2),
        inset 0 2px 0 rgba(255, 255, 255, 0.6), // Highlight modéré
        inset 0 -2px 0 rgba(200, 190, 180, 0.3);
      color: var(--color-text-secondary);

      &::before {
        background: linear-gradient(45deg,
            transparent 30%,
            rgba(255, 255, 255, 0.3) 50%, // Brillance modérée
            transparent 70%);
      }
    }

    // Thème clair par défaut (si pas de classe spécifique)
    background: linear-gradient(135deg,
      rgba(240, 235, 225, 0.9) 0%,
      rgba(235, 230, 220, 0.85) 50%,
      rgba(240, 235, 225, 0.9) 100%);
    border: none; // Pas de bordure pour le glassmorphism
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35),
    0 6px 20px rgba(0, 0, 0, 0.3),
    0 2px 8px rgba(0, 0, 0, 0.2),
    inset 0 2px 0 rgba(255, 255, 255, 0.6),
    inset 0 -2px 0 rgba(200, 190, 180, 0.3);

    // Adaptation pour le thème sombre
    :host-context(.appearance-sombre) &,
    .appearance-sombre & {
      background: linear-gradient(135deg,
          rgba(15, 20, 30, 0.7) 0%,
          rgba(20, 25, 35, 0.65) 50%,
          rgba(15, 20, 30, 0.7) 100%);
      border: none; // Pas de bordure pour le glassmorphism
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.5),
        0 4px 16px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        inset 0 -1px 0 rgba(0, 0, 0, 0.3);
      color: var(--color-text-secondary);

      &::before {
        background: linear-gradient(45deg,
            transparent 30%,
            rgba(255, 255, 255, 0.12) 50%,
            transparent 70%);
      }
    }
  }

  // PC : au-dessus du carrousel avec glassmorphism
  @media (min-width: 768px) {
    font-size: 1rem; // Réduit de 1.6rem
    margin-bottom: 0; // Pas de marge, géré par le gap du parent
    // Largeur élargie par rapport au bouton start-button
    width: 400px; // Élargi par rapport au bouton (300px -> 400px)
    padding: var(--spacing-xs) var(--spacing-md); // Padding pour le glassmorphism
    flex-shrink: 0; // Ne pas rétrécir, taille fixe
    color: var(--color-text-secondary); // Couleur suit le thème sur PC
    // Glassmorphism original : forme asymétrique avec effets visuels uniques
    backdrop-filter: blur(16px) saturate(200%) brightness(1.1);
    -webkit-backdrop-filter: blur(16px) saturate(200%) brightness(1.1);

    // Renforcement du backdrop-filter pour le mode clair
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      backdrop-filter: blur(20px) saturate(250%) brightness(1.15);
      -webkit-backdrop-filter: blur(20px) saturate(250%) brightness(1.15);
    }

    // Border-radius asymétrique pour une forme plus organique et originale
    border-radius: 20px 8px 20px 8px; // Coins alternés pour un effet unique
    box-sizing: border-box; // Inclut le padding dans la largeur (comme le bouton)
    position: relative;
    overflow: hidden;

    // Effet de brillance animé en arrière-plan
    &::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg,
          transparent 30%,
          rgba(255, 255, 255, 0.1) 50%,
          transparent 70%);
      animation: shimmer 8s infinite;
      pointer-events: none;
      z-index: 0;
    }

    // Le texte doit être au-dessus de l'effet de brillance
    >* {
      position: relative;
      z-index: 1;
    }

    // Adaptation pour le thème clair (explicite) - fond assombri pour meilleur contraste
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      background: linear-gradient(135deg,
          rgba(240, 235, 225, 0.9) 0%,
          rgba(235, 230, 220, 0.85) 50%,
          rgba(240, 235, 225, 0.9) 100%);
      border: none; // Pas de bordure pour le glassmorphism
      box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.35), // Ombre très prononcée
        0 6px 20px rgba(0, 0, 0, 0.3),
        0 2px 8px rgba(0, 0, 0, 0.2),
        inset 0 2px 0 rgba(255, 255, 255, 0.6), // Highlight modéré
        inset 0 -2px 0 rgba(200, 190, 180, 0.3);
      color: var(--color-text-secondary);

      &::before {
        background: linear-gradient(45deg,
            transparent 30%,
            rgba(255, 255, 255, 0.3) 50%, // Brillance modérée
            transparent 70%);
      }
    }

    // Thème clair par défaut (si pas de classe spécifique)
    background: linear-gradient(135deg,
      rgba(240, 235, 225, 0.9) 0%,
      rgba(235, 230, 220, 0.85) 50%,
      rgba(240, 235, 225, 0.9) 100%);
    border: none; // Pas de bordure pour le glassmorphism
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35),
    0 6px 20px rgba(0, 0, 0, 0.3),
    0 2px 8px rgba(0, 0, 0, 0.2),
    inset 0 2px 0 rgba(255, 255, 255, 0.6),
    inset 0 -2px 0 rgba(200, 190, 180, 0.3);

    // Adaptation pour le thème sombre
    :host-context(.appearance-sombre) &,
    .appearance-sombre & {
      background: linear-gradient(135deg,
          rgba(15, 20, 30, 0.7) 0%,
          rgba(20, 25, 35, 0.65) 50%,
          rgba(15, 20, 30, 0.7) 100%);
      border: none; // Pas de bordure pour le glassmorphism
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.5),
        0 4px 16px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        inset 0 -1px 0 rgba(0, 0, 0, 0.3);
      color: var(--color-text-secondary);

      &::before {
        background: linear-gradient(45deg,
            transparent 30%,
            rgba(255, 255, 255, 0.12) 50%,
            transparent 70%);
      }
    }
  }

  @media (min-width: 1024px) {
    font-size: 1.1rem; // Réduit de 1.8rem
    width: 450px; // Élargi par rapport au bouton (340px -> 450px)
  }

  @media (min-width: 1440px) {
    font-size: 1.2rem; // Réduit de 2rem
    width: 500px; // Élargi par rapport au bouton (380px -> 500px)
  }
}

// Animation de brillance pour le glassmorphism
@keyframes shimmer {
  0% {
    transform: translateX(-100%) translateY(-100%) rotate(45deg);
  }

  100% {
    transform: translateX(100%) translateY(100%) rotate(45deg);
  }
}

.buttons-container {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
  width: 100%;
  position: relative;

  @media (max-width: 767px) {
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-sm);
    justify-content: center; // Par défaut, centrer les boutons
    padding: 0;
    width: 100%;
    max-width: 85%; // Réduire la largeur disponible pour les autres modes

    .start-button {
      position: relative;
    }

    .config-button {
      position: relative;
      margin-left: var(--spacing-sm);
      flex-shrink: 0; // Ne pas rétrécir, garder la forme carrée
    }

    // Quand le bouton technique est présent (mode révision), répartir de manière homogène
    &:has(.technique-filter-button) {
      justify-content: space-between; // Répartir les boutons de manière homogène
      padding: 0;
      gap: var(--spacing-xs); // Réduire l'espace entre les boutons
      max-width: none; // Pas de limite de largeur en mode révision

      .start-button {
        flex: 0 1 auto; // Ne pas grandir, garder sa largeur naturelle
        max-width: 200px; // Même largeur max que dans les autres modes (min-width du start-button)
      }

      .config-button {
        margin-left: 0; // Retirer la marge car géré par gap
        flex-shrink: 0; // Ne pas rétrécir, garder la forme carrée
      }

      .technique-filter-button {
        flex-shrink: 0; // Ne pas rétrécir le bouton technique
      }
    }
  }
}

// Bouton de filtrage des techniques
.technique-filter-button {
  background: var(--color-surface);
  color: var(--color-text-primary);
  border: 2px solid var(--color-accent);
  border-radius: 12px;
  padding: 0; // Pas de padding pour garder le carré parfait
  font-size: 1rem;
  font-weight: var(--font-weight-medium);
  font-family: var(--font-family-primary);
  cursor: pointer;
  transition: all var(--transition-normal);
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 64px; // Carré : largeur = hauteur du bouton démarrer par défaut
  min-height: 64px; // Même hauteur que le bouton démarrer par défaut
  width: 64px; // Force la largeur à être égale à la hauteur
  height: 64px; // Force la hauteur
  box-shadow: var(--shadow-sm);
  position: relative;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  .technique-icon {
    width: 50px;
    height: 50px;
    object-fit: contain;
    transition: all var(--transition-normal);
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    z-index: 2;
    position: relative;

    // Mobile : réduire la taille de l'icône pour plus d'espace
    @media (max-width: 767px) {
      width: 48px;
      height: 48px;
    }

    // PC 768px : maximiser la taille dans un bouton de min-height 50px
    @media (min-width: 768px) {
      width: 46px;
      height: 46px;
    }

    // PC 1024px : maximiser la taille dans un bouton de min-height 56px
    @media (min-width: 1024px) {
      width: 52px;
      height: 52px;
    }

    // PC 1440px : maximiser la taille dans un bouton de min-height 64px
    @media (min-width: 1440px) {
      width: 60px;
      height: 60px;
    }
  }

  // Effet de fond animé (mobile)
  &::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: radial-gradient(circle, var(--color-accent) 0%, transparent 70%);
    transform: translate(-50%, -50%);
    transition: width 0.4s ease-out, height 0.4s ease-out, opacity 0.4s ease-out;
    opacity: 0;
    z-index: 0;
  }

  // Effet de brillance mobile
  &::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(255, 255, 255, 0.1) 50%,
      transparent 70%
    );
    transform: translate(-50%, -50%) rotate(45deg);
    transition: transform 0.6s ease-out;
    opacity: 0;
    z-index: 1;
  }

  &:hover {
    border-color: var(--color-accent);
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(var(--color-accent-rgb, 184, 92, 56), 0.3);

    &::before {
      width: 200%;
      height: 200%;
      opacity: 0.15;
    }

    &::after {
      transform: translate(50%, 50%) rotate(45deg);
      opacity: 1;
    }

    .technique-icon {
      transform: scale(1.1) rotate(5deg);
      filter: drop-shadow(0 4px 8px rgba(var(--color-accent-rgb, 184, 92, 56), 0.4));
    }
  }

  &:active {
    transform: translateY(0);
    box-shadow: var(--shadow-sm);

    .technique-icon {
      transform: scale(1.05);
    }
  }

  @media (max-width: 767px) {
    min-width: 60px; // Carré : largeur = hauteur du bouton démarrer sur mobile
    min-height: 60px; // Même hauteur que le bouton démarrer sur mobile
    width: 60px;
    height: 60px;
    padding: 0;
    letter-spacing: 0.5px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);

    // Style glassmorphism avec dégradé rouge (comme PC)
    background: linear-gradient(135deg, 
      rgba(196, 30, 58, 0.9) 0%, 
      rgba(230, 57, 70, 0.85) 50%,
      rgba(196, 30, 58, 0.9) 100%);
    color: #ffffff;
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 
      0 4px 12px rgba(196, 30, 58, 0.4),
      0 2px 4px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);

    // Effet de brillance animé au survol
    &::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 70%
      );
      transform: translate(-50%, -50%) rotate(45deg);
      transition: transform 0.6s ease-out;
      opacity: 0;
      z-index: 1;
    }

    // Effet de pulsation subtile
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      opacity: 0;
      animation: pulse 2s ease-in-out infinite;
      z-index: 0;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 0;
        transform: scale(1);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.05);
      }
    }

    .technique-icon {
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3)) brightness(1.1);
    }

    &:hover {
      background: linear-gradient(135deg, 
        rgba(230, 57, 70, 0.95) 0%, 
        rgba(196, 30, 58, 0.9) 50%,
        rgba(230, 57, 70, 0.95) 100%);
      border-color: rgba(255, 255, 255, 0.4);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 
        0 8px 24px rgba(196, 30, 58, 0.5),
        0 4px 8px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);

      &::before {
        transform: translate(50%, 50%) rotate(45deg);
        opacity: 1;
      }

      &::after {
        animation: none;
        opacity: 0;
      }

      .technique-icon {
        transform: scale(1.15) rotate(-5deg);
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4)) brightness(1.2);
      }
    }

    &:active {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.4),
        0 2px 4px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);

      .technique-icon {
        transform: scale(1.1);
      }
    }

    // Adaptation thème clair (mobile)
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      background: linear-gradient(135deg, 
        rgba(196, 30, 58, 0.85) 0%, 
        rgba(230, 57, 70, 0.8) 50%,
        rgba(196, 30, 58, 0.85) 100%);
      border-color: rgba(255, 255, 255, 0.25);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.35),
        0 2px 4px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);

      &:hover {
        background: linear-gradient(135deg, 
          rgba(230, 57, 70, 0.9) 0%, 
          rgba(196, 30, 58, 0.85) 50%,
          rgba(230, 57, 70, 0.9) 100%);
        border-color: rgba(255, 255, 255, 0.4);
        box-shadow: 
          0 8px 24px rgba(196, 30, 58, 0.45),
          0 4px 8px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.4);
      }
    }

    // Adaptation thème sombre (mobile)
    :host-context(.appearance-sombre) &,
    .appearance-sombre & {
      background: linear-gradient(135deg, 
        rgba(196, 30, 58, 0.75) 0%, 
        rgba(230, 57, 70, 0.7) 50%,
        rgba(196, 30, 58, 0.75) 100%);
      border-color: rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.5),
        0 2px 4px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);

      &:hover {
        background: linear-gradient(135deg, 
          rgba(230, 57, 70, 0.85) 0%, 
          rgba(196, 30, 58, 0.8) 50%,
          rgba(230, 57, 70, 0.85) 100%);
        border-color: rgba(255, 255, 255, 0.25);
        box-shadow: 
          0 8px 24px rgba(196, 30, 58, 0.6),
          0 4px 8px rgba(0, 0, 0, 0.5),
          inset 0 1px 0 rgba(255, 255, 255, 0.15);
      }
    }
  }

  // Sur PC : style glassmorphism moderne avec effet de profondeur, adapté aux thèmes
  @media (min-width: 768px) {
    padding: 0; // Pas de padding pour garder le carré parfait
    width: 50px; // Carré : largeur = hauteur
    height: 50px; // Carré : hauteur = largeur
    min-width: 50px;
    min-height: 50px;
    letter-spacing: 0.5px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);

    // Style par défaut (thème clair)
    background: linear-gradient(135deg, 
      rgba(196, 30, 58, 0.9) 0%, 
      rgba(230, 57, 70, 0.85) 50%,
      rgba(196, 30, 58, 0.9) 100%);
    color: #ffffff;
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 
      0 4px 12px rgba(196, 30, 58, 0.4),
      0 2px 4px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);

    // Effet de brillance animé au survol
    &::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 70%
      );
      transform: translate(-50%, -50%) rotate(45deg);
      transition: transform 0.6s ease-out;
      opacity: 0;
      z-index: 1;
    }

    // Effet de pulsation subtile
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      opacity: 0;
      animation: pulse 2s ease-in-out infinite;
      z-index: 0;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 0;
        transform: scale(1);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.05);
      }
    }

    .technique-icon {
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3)) brightness(1.1);
    }

    &:hover {
      background: linear-gradient(135deg, 
        rgba(230, 57, 70, 0.95) 0%, 
        rgba(196, 30, 58, 0.9) 50%,
        rgba(230, 57, 70, 0.95) 100%);
      border-color: rgba(255, 255, 255, 0.4);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 
        0 8px 24px rgba(196, 30, 58, 0.5),
        0 4px 8px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);

      &::before {
        transform: translate(50%, 50%) rotate(45deg);
        opacity: 1;
      }

      &::after {
        animation: none;
        opacity: 0;
      }

      .technique-icon {
        transform: scale(1.15) rotate(-5deg);
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4)) brightness(1.2);
      }
    }

    &:active {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.4),
        0 2px 4px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);

      .technique-icon {
        transform: scale(1.1);
      }
    }

    &:focus {
      outline: 3px solid rgba(196, 30, 58, 0.5);
      outline-offset: 3px;
    }

    // Adaptation thème clair (PC)
    :host-context(.appearance-clair) &,
    .appearance-clair & {
      background: linear-gradient(135deg, 
        rgba(196, 30, 58, 0.85) 0%, 
        rgba(230, 57, 70, 0.8) 50%,
        rgba(196, 30, 58, 0.85) 100%);
      border-color: rgba(255, 255, 255, 0.25);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.35),
        0 2px 4px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);

      &:hover {
        background: linear-gradient(135deg, 
          rgba(230, 57, 70, 0.9) 0%, 
          rgba(196, 30, 58, 0.85) 50%,
          rgba(230, 57, 70, 0.9) 100%);
        border-color: rgba(255, 255, 255, 0.4);
        box-shadow: 
          0 8px 24px rgba(196, 30, 58, 0.45),
          0 4px 8px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.4);
      }
    }

    // Adaptation thème sombre (PC)
    :host-context(.appearance-sombre) &,
    .appearance-sombre & {
      background: linear-gradient(135deg, 
        rgba(196, 30, 58, 0.75) 0%, 
        rgba(230, 57, 70, 0.7) 50%,
        rgba(196, 30, 58, 0.75) 100%);
      border-color: rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 4px 12px rgba(196, 30, 58, 0.5),
        0 2px 4px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);

      &:hover {
        background: linear-gradient(135deg, 
          rgba(230, 57, 70, 0.85) 0%, 
          rgba(196, 30, 58, 0.8) 50%,
          rgba(230, 57, 70, 0.85) 100%);
        border-color: rgba(255, 255, 255, 0.25);
        box-shadow: 
          0 8px 24px rgba(196, 30, 58, 0.6),
          0 4px 8px rgba(0, 0, 0, 0.5),
          inset 0 1px 0 rgba(255, 255, 255, 0.15);
      }
    }
  }

  @media (min-width: 1024px) {
    width: 56px; // Carré : largeur = hauteur
    height: 56px; // Carré : hauteur = largeur
    min-width: 56px;
    min-height: 56px;
  }

  @media (min-width: 1440px) {
    width: 80px; // Carré : largeur = hauteur
    height: 80px; // Carré : hauteur = largeur
    min-width: 64px;
    min-height: 64px;
  }
}

// Carousel des modes de passage
.mode-carousel-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
  width: 100%;
  position: relative;

  @media (max-width: 767px) {
    flex-direction: column;
    gap: var(--spacing-sm);
  }
}

.mode-carousel-wrapper .carousel-nav-left,
.mode-carousel-wrapper .carousel-nav-right {
  @media (max-width: 767px) {
    display: none !important;
  }
}

.logo-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-lg);
  background: var(--color-surface);
  border-radius: 16px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-normal);
  height: 180px;
  position: relative;
  width: 180px;
  overflow: visible;

  @media (max-width: 767px) {
    overflow: visible;
  }

  &:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }

  @media (min-width: 768px) {
    padding: var(--spacing-lg); // Réduit de spacing-xl à spacing-lg
    height: 300px; // Réduit de 340px à 300px
    width: 320px; // Réduit de 360px à 320px
  }

  @media (min-width: 1024px) {
    padding: var(--spacing-xl); // Réduit
    height: 340px; // Réduit de 400px à 340px
    width: 360px; // Réduit de 432px à 360px
  }

  @media (min-width: 1440px) {
    padding: calc(var(--spacing-xl) + 0.5rem); // Réduit
    height: 380px; // Réduit de 440px à 380px
    width: 400px; // Réduit de 480px à 400px
  }
}

.mode-icon-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  pointer-events: none;
}

.mode-text {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  width: 100%;
  position: absolute;
  bottom: var(--spacing-md);
  left: 0;
  right: 0;
  z-index: 1;
  padding: 0 var(--spacing-lg);

  &.transitioning.direction-right {
    animation: slideOutLeftText 0.2s ease-in-out forwards;
  }

  &.transitioning.direction-left {
    animation: slideOutRightText 0.2s ease-in-out forwards;
  }

  &.entering.direction-right {
    transform: translateX(100%);
    opacity: 0;
    animation: slideInFromRightText 0.2s ease-in-out forwards;
  }

  &.entering.direction-left {
    transform: translateX(-100%);
    opacity: 0;
    animation: slideInFromLeftText 0.2s ease-in-out forwards;
  }

  @media (min-width: 768px) {
    bottom: var(--spacing-lg);
    padding: 0 var(--spacing-xl);
  }

  @media (min-width: 1024px) {
    bottom: calc(var(--spacing-lg) + 0.5rem);
    padding: 0 calc(var(--spacing-xl) + 0.5rem);
  }

  @media (min-width: 1440px) {
    bottom: calc(var(--spacing-lg) + 1rem);
    padding: 0 calc(var(--spacing-xl) + 1rem);
  }
}

.carousel-nav {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--color-surface);
  color: var(--color-primary);
  border: 2px solid var(--color-border);
  cursor: pointer;
  transition: all var(--transition-fast);
  flex-shrink: 0;
  box-shadow: var(--shadow-sm);

  &:hover {
    background: var(--color-accent);
    color: #ffffff;
    border-color: var(--color-accent);
    transform: scale(1.1);
    box-shadow: var(--shadow-md);
  }

  &:active {
    transform: scale(0.95);
  }

  svg {
    width: 24px;
    height: 24px;
  }
}

.carousel-nav-left-mobile svg,
.carousel-nav-right-mobile svg {
  @media (max-width: 767px) {
    width: 32px;
    height: 32px;
  }
}

.carousel-nav-left-mobile,
.carousel-nav-right-mobile {
  display: none;

  @media (max-width: 767px) {
    display: flex;
    position: absolute;
    top: 0;
    bottom: 0;
    height: 100%;
    width: 60px;
    align-items: center;
    justify-content: center;
    z-index: 10;
    pointer-events: auto;
    background: transparent;
    border: none;
    border-radius: 0;
    box-shadow: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
    color: var(--color-primary);
    transition: color var(--transition-fast), opacity var(--transition-fast);

    &:hover {
      background: transparent;
      transform: none;
      box-shadow: none;
      opacity: 0.8;
      color: var(--color-accent);
    }

    &:active {
      transform: none;
      opacity: 1;
      color: var(--color-accent);
    }
  }
}

.carousel-nav-left-mobile {
  @media (max-width: 767px) {
    left: 0;
  }
}

.carousel-nav-right-mobile {
  @media (max-width: 767px) {
    right: 0;
  }
}

.mode-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100px;
  height: 100px;

  svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
  }

  @media (min-width: 768px) {
    width: 150px; // Réduit de 170px
    height: 150px; // Réduit de 170px
  }

  @media (min-width: 1024px) {
    width: 170px; // Réduit de 200px
    height: 170px; // Réduit de 200px
  }

  @media (min-width: 1440px) {
    width: 200px; // Réduit de 240px
    height: 200px; // Réduit de 240px
  }
}

.mode-name {
  font-size: 1.2rem;
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  text-align: center;
  text-shadow: 0 1px 2px rgba(61, 47, 31, 0.1);
  white-space: nowrap;
  margin-bottom: var(--spacing-xs);

  @media (min-width: 768px) {
    font-size: 1.4rem;
  }

  @media (min-width: 1024px) {
    font-size: 1.6rem;
  }

  @media (min-width: 1440px) {
    font-size: 1.8rem;
  }
}

.mode-description {
  font-size: 0.75rem; // Augmenté de 0.65rem à 0.75rem pour mobile
  font-weight: 400;
  font-style: italic;
  color: var(--color-text-secondary);
  text-align: center;
  opacity: 0.8;
  margin-top: 0;
  line-height: 1.3;
  max-width: 95%; // Augmenté de 90% à 95%

  @media (min-width: 768px) {
    font-size: 0.7rem;
    max-width: 95%; // Augmenté de 90% à 95%
  }

  @media (min-width: 1024px) {
    font-size: 0.75rem;
    max-width: 95%; // Augmenté de 90% à 95%
  }

  @media (min-width: 1440px) {
    font-size: 0.8rem;
    max-width: 95%; // Augmenté de 90% à 95%
  }
}


.start-button {
  background: linear-gradient(135deg, var(--color-button-primary) 0%, var(--color-button-primary-light) 100%);
  color: #ffffff;
  border: none;
  border-radius: 12px;
  padding: var(--spacing-md) var(--spacing-xl);
  font-family: var(--font-family-primary);
  font-size: 1.8rem;
  font-weight: var(--font-weight-bold);
  cursor: pointer;
  transition: all var(--transition-normal);
  min-height: 64px;
  min-width: 220px;
  box-shadow: var(--button-shadow-default);
  letter-spacing: 0.5px;
  position: relative;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  white-space: nowrap;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left var(--transition-slow);
  }

  &:hover {
    transform: translateY(-3px);
    box-shadow: var(--button-shadow-hover);

    &::before {
      left: 100%;
    }
  }

  &:active {
    transform: translateY(-1px);
    box-shadow: var(--button-shadow-active);
  }

  &:focus {
    outline: 3px solid var(--color-button-primary);
    outline-offset: 3px;
  }

  @media (max-width: 767px) {
    min-height: 60px;
    min-width: 200px;
    font-size: 1.4rem;
    padding: var(--spacing-sm) var(--spacing-md);
    flex: 1;
    max-width: none;
  }

  @media (min-width: 768px) {
    font-size: 1.9rem; // Réduit encore
    padding: var(--spacing-sm) calc(var(--spacing-xl) + 1rem); // Réduit padding vertical
    min-width: 300px; // Réduit
    min-height: 50px; // Réduit de 56px
  }

  @media (min-width: 1024px) {
    font-size: 2.1rem; // Réduit encore
    padding: var(--spacing-sm) calc(var(--spacing-xl) + 2rem); // Réduit padding vertical
    min-width: 340px; // Réduit
    min-height: 56px; // Réduit de 64px
  }

  @media (min-width: 1440px) {
    font-size: 2.4rem; // Réduit encore
    min-width: 380px; // Réduit
    min-height: 64px; // Réduit de 72px
  }
}

// Réduction de la largeur du bouton démarrer uniquement en mode révision sur PC
.buttons-container.revision-mode {
  @media (min-width: 768px) {
    .start-button {
      min-width: 260px; // Réduit de 300px
    }
  }

  @media (min-width: 1024px) {
    .start-button {
      min-width: 290px; // Réduit de 340px
    }
  }

  @media (min-width: 1440px) {
    .start-button {
      min-width: 330px; // Réduit de 380px
    }
  }
}

.config-panel {
  width: 100%;
  max-width: 500px;
  background: var(--color-surface);
  border-radius: 16px;
  box-shadow: var(--shadow-md);
  overflow: visible;
  transition: all var(--transition-normal);
  flex-shrink: 0;
  position: relative; // Pour positionner l'icône de réglage

  @media (max-width: 767px) {
    display: none;
  }

  @media (min-width: 768px) {
    max-width: 600px;
    flex: 0 1 600px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    align-self: center; // Centre le panel au lieu de l'étirer
    max-height: 98%; // Limite la hauteur à 98% de la hauteur disponible
    min-height: 0; // Permet au flex de fonctionner correctement

    .config-content {
      display: block;
      padding: var(--spacing-lg);
      overflow-y: auto;
      overflow-x: hidden;
      flex: 1;
      min-height: 0;
      position: relative;
      // Masquer la scrollbar tout en gardant le scroll
      scrollbar-width: none; // Firefox
      -ms-overflow-style: none; // IE et Edge

      &::-webkit-scrollbar {
        display: none; // Chrome, Safari, Opera
      }
    }
  }

  @media (min-width: 1024px) {
    max-width: 700px;
    flex: 0 1 700px;
  }

  @media (min-width: 1440px) {
    max-width: 800px;
    flex: 0 1 800px;
  }
}

// Icône de réglage en haut à droite du panel de configuration (non cliquable)
.config-settings-icon {
  position: absolute;
  top: var(--spacing-lg);
  right: var(--spacing-lg);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: var(--color-text-secondary);
  z-index: 10;
  padding: 0;
  pointer-events: none; // Empêche toute interaction

  svg {
    width: 24px;
    height: 24px;
  }
}

// Icône de souris animée en bas du panel pour indiquer le scroll (PC uniquement)
.config-scroll-indicator {
  display: none; // Masqué sur mobile

  @media (min-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    bottom: var(--spacing-xs);
    left: 50%;
    transform: translateX(-50%);
    color: var(--color-text-secondary);
    pointer-events: none;
    z-index: 5;
    opacity: 1;
    transition: opacity 0.3s ease-out;

    &.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .scroll-indicator-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0; // Collé, sans espace entre la souris et le chevron
      animation: scrollIndicatorMove 2s ease-in-out infinite;
    }

    .mouse-icon {
      width: 40px;
      height: 52px;
      display: block;
      vertical-align: bottom;
      margin-bottom: -12px; // Fait descendre la souris pour qu'elle chevauche le chevron
    }

    .chevron-icon {
      width: 24px;
      height: 24px;
    }
  }
}

// Animation pour l'indicateur de scroll (mouvement vers le bas)
@keyframes scrollIndicatorMove {

  0%,
  100% {
    transform: translateY(0);
    opacity: 0.6;
  }

  50% {
    transform: translateY(8px);
    opacity: 1;
  }
}

.config-content {
  padding: 0 var(--spacing-lg) var(--spacing-lg);
  animation: slideDown var(--transition-normal) ease-out;
  overflow: visible;

  @media (max-width: 767px) {
    overflow: visible;
    max-height: none;
  }

  // Sur PC, les styles sont définis dans .config-panel @media (min-width: 768px)
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.config-section {
  h3 {
    margin: 0 0 var(--spacing-xs) 0;
    font-size: 1.25rem;
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
    text-shadow: 0 1px 2px rgba(61, 47, 31, 0.1);
  }

  .config-description {
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text-secondary);
    font-size: 0.9rem;
  }
}

.config-placeholder {
  padding: var(--spacing-lg);
  background: var(--color-background);
  border-radius: 8px;
  text-align: center;
  color: var(--color-text-secondary);
  font-size: 0.9rem;
  border: 2px dashed var(--color-border);
}

// Section Sélection du grade (PC)
.grade-selection-section {
  margin-bottom: var(--spacing-lg);
}

.grade-selector {
  position: relative;
  margin-top: var(--spacing-md);
  width: 100%;
}

.grade-select-button {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  width: 100%;
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 0.875rem; // 14px - compact
  font-weight: var(--font-weight-medium);
  color: var(--color-text-primary);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  cursor: pointer;
  transition: all var(--transition-fast);
  box-sizing: border-box;
  min-height: 36px; // Compact mais touchable
  justify-content: space-between;

  .grade-select-label {
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-normal);
    white-space: nowrap;
  }

  .grade-select-value {
    flex: 1;
    text-align: left;
    color: var(--color-text-primary);
    font-weight: var(--font-weight-medium);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .grade-select-chevron {
    flex-shrink: 0;
    width: 14px;
    height: 14px;
    color: var(--color-text-secondary);
    transition: transform var(--transition-fast);
  }

  // État hover
  &:hover {
    border-color: var(--color-primary);
    background-color: var(--color-background);
    color: var(--color-text-primary);

    .grade-select-label,
    .grade-select-value {
      color: var(--color-text-primary);
    }

    .grade-select-chevron {
      color: var(--color-text-secondary);
    }
  }

  // État ouvert
  &.open {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb, 61, 47, 31), 0.1);
    background-color: var(--color-surface);

    .grade-select-chevron {
      transform: rotate(180deg);
      color: var(--color-primary);
    }
  }

  // État focus
  &:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb, 61, 47, 31), 0.15);
  }

  // État disabled
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    color: var(--color-text-secondary);
    background-color: var(--color-background);
  }
}

.grade-dropdown {
  position: absolute;
  top: calc(100% + var(--spacing-xs));
  left: 0;
  right: 0;
  z-index: 1000;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
  gap: 6px;
  padding: var(--spacing-sm);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  box-shadow: var(--shadow-lg);
  max-height: 300px;
  overflow-y: auto;
  margin-top: 2px;

  @media (min-width: 1024px) {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  }

  // Assurer que le scrollbar utilise les couleurs du thème
  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: var(--color-background);
    border-radius: 4px;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 4px;

    &:hover {
      background: var(--color-primary);
    }
  }
}

.grade-option {
  padding: var(--spacing-xs) var(--spacing-sm);
  font-size: 0.8125rem; // 13px - très compact
  font-weight: var(--font-weight-medium);
  color: var(--color-text-primary);
  background: var(--color-background);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  cursor: pointer;
  transition: all var(--transition-fast);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-height: 28px; // Compact
  box-sizing: border-box;

  // État hover
  &:hover {
    border-color: var(--color-primary);
    background-color: var(--color-surface);
    color: var(--color-text-primary);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  // État sélectionné
  &.selected {
    border-color: var(--color-primary);
    background-color: var(--color-primary);
    // Pour le texte sur fond primary, utiliser le contraste approprié selon le thème
    // En clair: primary est sombre, donc texte clair. En sombre: primary est clair, donc texte sombre.
    color: var(--color-background);
    font-weight: var(--font-weight-semibold);
    box-shadow: var(--shadow-sm);

    // S'assurer que le texte reste lisible sur thème sombre où primary peut être clair
    // On utilise --color-text-primary comme fallback si nécessaire, mais --color-background devrait fonctionner
  }

  // État focus
  &:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb, 61, 47, 31), 0.2);
  }

  // État disabled
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    color: var(--color-text-secondary);
    background-color: var(--color-background);
  }
}

// Section Configuration du temps
.time-configuration-section {
  margin-bottom: var(--spacing-md);
}

.time-controls-row {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);

  // Sur PC, afficher les 3 contrôles en ligne
  @media (min-width: 768px) {
    flex-direction: row;
    gap: var(--spacing-lg);
    align-items: flex-start;
  }
}

// Section Options supplémentaires
.additional-options-section {
  margin-bottom: var(--spacing-lg);

  @media (min-width: 768px) {
    margin-bottom: var(--spacing-lg);
  }

  // Réduire l'espace au-dessus des toggles
  .config-description {
    margin-bottom: var(--spacing-sm);
  }
}

// Conteneur pour les toggles armes et randori (affichage en ligne sur PC)
.weapon-randori-toggles {
  margin-bottom: 0;
  margin-top: 0;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);

  // Sur PC, afficher les boutons pill centrés
  @media (min-width: 768px) {
    align-items: center;
    gap: 0;
  }
}

// Conteneur pour les boutons pill sur PC
.pill-toggles-container {
  display: none; // Masquer sur mobile

  // Afficher sur PC
  @media (min-width: 768px) {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-xs);
    width: 100%;
    margin-top: 0;
  }
}

.pill-toggles-buttons {
  display: none; // Masquer sur mobile

  // Afficher sur PC
  @media (min-width: 768px) {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    justify-content: center;
    width: 100%;
  }
}

// Toggle pour mobile (style avec le petit switch)
.weapon-time-toggle-mobile {
  margin-bottom: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--spacing-md);
  padding: var(--spacing-sm) var(--spacing-md);
  background: var(--color-background);
  border: 1px solid var(--color-border);
  border-radius: 8px;

  // Masquer sur PC
  @media (min-width: 768px) {
    display: none;
  }
}

.weapon-time-toggle-label {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--spacing-md);
  cursor: pointer;
  width: 100%;
  margin: 0;
}

.weapon-time-toggle-text-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.weapon-time-toggle-text {
  font-size: 1rem; // 16px sur mobile
  font-weight: var(--font-weight-medium);
  color: var(--color-text-primary);
}

.weapon-time-toggle-duration {
  font-size: 0.75rem; // 12px - plus petit pour la durée
  font-weight: var(--font-weight-normal);
  color: var(--color-text-secondary);
  opacity: 0.8;
}

// Boutons Pill/Tab style pour PC
.pill-toggle-button {
  display: none; // Masquer sur mobile

  // Afficher sur PC
  @media (min-width: 768px) {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-sm) var(--spacing-lg);
    font-size: 0.875rem; // 14px
    font-weight: var(--font-weight-medium);
    color: var(--color-text-primary);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 20px; // Pill shape
    cursor: pointer;
    transition: all var(--transition-fast);
    white-space: nowrap;
    min-height: 32px;
    width: 35%; // 35% de la largeur disponible pour chaque bouton
    flex-shrink: 0;
    position: relative; // Pour positionner la pastille

    // Hover sur PC
    &:hover:not(.active) {
      border-color: var(--color-primary);
      background: rgba(var(--color-primary-rgb, 61, 47, 31), 0.05);
      color: var(--color-primary);
    }

    // État actif (surbrillance)
    &.active {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: var(--color-background);
      font-weight: var(--font-weight-semibold);
      box-shadow: 0 2px 8px rgba(var(--color-primary-rgb, 61, 47, 31), 0.25);

      // Pastille sur le bord haut droit (même style que les boutons de thème)
      &::before {
        content: '';
        position: absolute;
        top: 0px;
        right: 0px;
        width: 24px;
        height: 24px;
        background-color: var(--color-accent);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      // Coche dans la pastille (même style que les boutons de thème)
      &::after {
        content: '✓';
        position: absolute;
        top: 0px;
        right: 0px;
        width: 24px;
        height: 24px;
        color: var(--color-background);
        font-size: 14px;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 11; // Au-dessus de ::before
      }
    }

    // État focus
    &:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb, 61, 47, 31), 0.15);
    }

    // Désactiver le tap highlight
    -webkit-tap-highlight-color: transparent;
  }
}

.pill-toggle-duration {
  font-size: 0.875rem; // 14px - même taille que le texte parent
  font-weight: var(--font-weight-normal);
  font-style: italic;
  opacity: 0.9;
  margin-left: 4px; // Espace entre "RANDORI" et "(3 min)"

  // Quand le bouton est actif, la durée suit la couleur du bouton (couleur background)
  .pill-toggle-button.active & {
    color: var(--color-background);
    opacity: 0.95;
  }
}

// Section Sélection de la voix (PC)
.voice-selection-section {
  margin-bottom: 0;

  @media (max-width: 767px) {
    margin-bottom: var(--spacing-xl);
    padding-bottom: var(--spacing-lg);
  }

  .config-description {
    margin-bottom: var(--spacing-xs);
  }

  .voice-language-group {
    .voice-language-title {
      margin: 0 0 var(--spacing-xs) 0;
      font-size: 0.875rem; // 14px
      font-weight: var(--font-weight-semibold); // 600
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;

      @media (max-width: 767px) {
        font-size: 0.8125rem; // 13px
        margin-bottom: var(--spacing-xs);
      }
    }

    &.voice-language-group-japanese {
      margin-top: var(--spacing-md);
    }

    &.voice-language-group-french {
      margin-top: calc(var(--spacing-xl) * 1.5);
      margin-bottom: var(--spacing-md);
    }
  }
}

.voice-selector {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
  gap: var(--spacing-md);
  margin-top: var(--spacing-md);
  width: 100%;
  box-sizing: border-box;
  justify-items: center;
  row-gap: calc(var(--spacing-md) + 35px);

  @media (max-width: 767px) {
    grid-template-columns: repeat(auto-fit, minmax(65px, 1fr));
    gap: var(--spacing-sm);
    row-gap: calc(var(--spacing-sm) + 30px);
  }
}

.voice-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
  padding: var(--spacing-xs);
  background-color: var(--color-surface);
  border: 2px solid var(--color-border);
  border-radius: 50%;
  aspect-ratio: 1;
  cursor: pointer;
  position: relative;
  box-sizing: border-box;
  overflow: visible;
  justify-content: center;
  padding-bottom: 0;
  width: 100%;
  max-width: 80px;

  @media (max-width: 767px) {
    max-width: 65px;
    padding: 4px;
  }

  &:hover {
    border-color: var(--color-accent);
    box-shadow: var(--shadow-md);
  }

  &.active {
    border-color: var(--color-accent);
    background-color: var(--color-background);
    box-shadow: var(--shadow-lg);
    border-width: 3px;

    &::before {
      content: '';
      position: absolute;
      top: -2px;
      right: -2px;
      width: 24px;
      height: 24px;
      background-color: var(--color-accent);
      border-radius: 50%;
      z-index: 10;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    &::after {
      content: '✓';
      position: absolute;
      top: -2px;
      right: -2px;
      width: 24px;
      height: 24px;
      color: var(--color-background);
      font-size: 14px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 11;
    }
  }

  &:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb, 61, 47, 31), 0.15);
  }

  -webkit-tap-highlight-color: transparent;
}

.voice-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  width: calc(80px - var(--spacing-xs) * 2 - 4px);
  height: calc(80px - var(--spacing-xs) * 2 - 4px);
  border-radius: 50%;
  overflow: visible;
  z-index: 1;
  position: relative;
  margin: 0 auto;
  flex-shrink: 0;
  background-color: transparent;
  color: var(--color-primary);

  @media (min-width: 768px) {
    transform: translateY(-4px);
  }

  @media (max-width: 767px) {
    width: calc(65px - 8px - 4px);
    height: calc(65px - 8px - 4px);
  }

  .voice-avatar {
    width: 145%;
    height: 145%;
    object-fit: contain;
    border-radius: 50%;
    transform: translateY(-4px);
  }
}

.voice-option.active .voice-preview {
  @media (min-width: 768px) {
    transform: translate(-1px, -4px);
  }

  @media (max-width: 767px) {
    transform: translateX(-1px);
  }
}

.voice-name {
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-primary);
  font-size: 0.95rem;
  text-align: center;
  z-index: 1;
  position: absolute;
  bottom: -35px;
  left: 50%;
  transform: translateX(-50%);
  white-space: nowrap;
  width: auto;
  overflow: hidden;
  text-overflow: ellipsis;
  pointer-events: none;

  @media (max-width: 767px) {
    font-size: 0.85rem;
    bottom: -30px;
  }
}

// La coche a été remplacée par une pastille via ::before et ::after sur .pill-toggle-button.active

// Styles pour le toggle switch sur mobile uniquement
.weapon-time-toggle-button {
  position: relative;
  width: 48px;
  height: 26px;
  padding: 0;
  background: var(--color-border);
  border: 1px solid var(--color-border);
  border-radius: 13px;
  cursor: pointer;
  transition: all var(--transition-fast);
  flex-shrink: 0;

  // Masquer sur PC
  @media (min-width: 768px) {
    display: none;
  }

  &:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb, 61, 47, 31), 0.15);
  }

  &:hover {
    border-color: var(--color-primary);
  }

  &.active {
    background: var(--color-primary);
    border-color: var(--color-primary);
  }
}

.weapon-time-toggle-slider {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 22px;
  height: 22px;
  background: var(--color-surface);
  border-radius: 50%;
  transition: transform var(--transition-fast);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  .weapon-time-toggle-button.active & {
    transform: translateX(22px);
  }
}

.time-control {
  flex: 1;
  margin-bottom: 0;

  .time-control-label {
    display: block;
    margin-bottom: var(--spacing-xs);
    font-size: 0.875rem; // 14px
    font-weight: var(--font-weight-medium);
    color: var(--color-text-primary);
  }
}

.time-input-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  width: 100%;
}

.time-input-button {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  width: 32px;
  height: 32px;
  padding: 0;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  cursor: pointer;
  transition: all var(--transition-fast);
  color: var(--color-text-primary);

  svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
  }

  // État hover
  &:hover:not(:disabled) {
    background: var(--color-background);
    border-color: var(--color-primary);
    color: var(--color-primary);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  // État focus
  &:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb, 61, 47, 31), 0.15);
  }

  // État disabled
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: var(--color-background);
    border-color: var(--color-border);
    color: var(--color-text-secondary);

    svg {
      opacity: 0.5;
    }
  }

  // Désactiver le tap highlight sur mobile
  -webkit-tap-highlight-color: transparent;
}

.time-value {
  flex: 1;
  min-width: 0;
  padding: var(--spacing-xs) var(--spacing-sm);
  font-size: 0.9375rem; // 15px
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  text-align: center;
  box-sizing: border-box;
  min-height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.time-input-unit {
  flex-shrink: 0;
  font-size: 0.8125rem; // 13px
  font-weight: var(--font-weight-normal);
  color: var(--color-text-secondary);
  white-space: nowrap;
  padding: 0 var(--spacing-xs);
}

.time-preview {
  margin-top: var(--spacing-md);
  padding: var(--spacing-sm);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  text-align: center;

  // Réduire la hauteur sur PC
  @media (min-width: 768px) {
    padding: var(--spacing-xs) var(--spacing-sm);
    margin-top: var(--spacing-sm);
  }
}

.time-preview-text {
  margin: 0;
  font-size: 0.8125rem; // 13px
  color: var(--color-text-secondary);
  line-height: 1.5;

  // Réduire la taille du texte sur PC
  @media (min-width: 768px) {
    font-size: 0.75rem; // 12px
    line-height: 1.4;
  }
}

.time-preview-count {
  font-size: 1.125rem; // 18px
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  margin: 0 var(--spacing-xs);

  // Réduire la taille sur PC
  @media (min-width: 768px) {
    font-size: 1rem; // 16px
  }
}

.config-button {
  background: linear-gradient(135deg, var(--color-secondary) 0%, #3d3d3d 100%);
  color: #ffffff;
  border: none;
  border-radius: 12px;
  padding: 0;
  cursor: pointer;
  transition: all var(--transition-normal);
  text-decoration: none;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(90, 74, 58, 0.3);

  @media (max-width: 767px) {
    min-width: 60px; // Force la largeur minimale
    min-height: 60px; // Force la hauteur minimale
    width: 60px; // Largeur fixe
    height: 60px; // Hauteur fixe
    aspect-ratio: 1; // Force le ratio 1:1 (carré parfait)
    flex-shrink: 0; // Ne pas rétrécir
  }

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left var(--transition-slow);
  }

  &:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 28px rgba(45, 45, 45, 0.4);

    &::before {
      left: 100%;
    }
  }

  &:active {
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(90, 74, 58, 0.3);
  }

  &:focus {
    outline: 3px solid var(--color-secondary);
    outline-offset: 3px;
  }

  svg {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
  }

  @media (min-width: 768px) {
    display: none;
  }
}

@media (max-width: 767px) {
  .home-page {
    overflow: hidden;
    display: flex;
    align-items: flex-start; // Alignement en haut pour laisser le titre sous la bannière
    justify-content: center;
    padding: var(--spacing-sm) var(--spacing-md) 0; // Padding en haut et sur les côtés pour centrer le contenu

    .home-content {
      justify-content: flex-start; // Titre en haut
      align-items: center;
      padding: 0; // Pas de padding supplémentaire, géré par home-page
      height: 100%;
      min-height: 100%;
      width: 100%;
    }
  }

  .home-content {
    gap: 0; // Pas de gap, géré individuellement
    padding-top: 0; // Pas de padding supplémentaire
    justify-content: flex-start; // Titre en haut
    align-items: center;
    width: 100%;
  }

  .main-actions {
    width: 100%;
    align-items: center; // Centre les enfants horizontalement
    flex: 1; // Prend toute la hauteur disponible
    justify-content: space-between; // Espacement maximum pour occuper toute la hauteur
    padding-top: 0;
    gap: var(--spacing-sm); // Espacement réduit entre les éléments
    min-height: 0; // Permet au flex de fonctionner correctement
  }

  .logo-container {
    padding: var(--spacing-md);
    height: 280px;
    width: 90vw;
  }

  .mode-icon {
    width: 180px;
    height: 180px;
  }

  .mode-name {
    font-size: 1.1rem;
  }

  .mode-description {
    font-size: 0.75rem; // Augmenté de 0.6rem à 0.75rem pour mobile
    max-width: 95%; // Augmenté de 90% à 95%
  }

  .buttons-container {
    width: 100%;
    max-width: 85%; // Réduire la largeur disponible pour les autres modes
    margin-top: var(--spacing-sm);
    display: flex;
    flex-direction: row;
    justify-content: center; // Par défaut, centrer les boutons
    align-items: center;
    gap: var(--spacing-sm);
    padding: 0;

    // Quand le bouton technique est présent (mode révision), répartir de manière homogène
    &:has(.technique-filter-button) {
      max-width: none; // Pas de limite de largeur en mode révision
      justify-content: space-between; // Répartir les boutons de manière homogène
      gap: var(--spacing-xs); // Réduire l'espace entre les boutons

      .start-button {
        flex: 0 1 auto; // Ne pas grandir, garder sa largeur naturelle
        max-width: 200px; // Même largeur max que dans les autres modes (min-width du start-button)
      }

      .technique-filter-button {
        flex-shrink: 0; // Ne pas rétrécir le bouton technique
      }
    }
  }

  .mode-carousel-wrapper {
    margin-bottom: var(--spacing-sm);
  }
}

@media (min-width: 768px) {
  .home-page {
    overflow: hidden;
  }

  .home-content {
    gap: var(--spacing-xl);
    height: 100%;
    width: 100%;
    box-sizing: border-box; // Inclut le padding dans la hauteur
    overflow: hidden; // Pas de scroll
  }

  .config-panel {
    // La hauteur est automatiquement alignée avec main-actions
    // grâce à align-items: stretch sur .home-content
    // Le scroll vertical est disponible à l'intérieur du panel (config-content)
    // La scrollbar est cachée pour un design plus épuré
  }
}

// Overlay pour la popup/modal Technique Filter
.technique-filter-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: var(--spacing-md);
  padding-top: calc(72px + var(--spacing-xs) * 2 + var(--spacing-md));
  animation: fadeIn 0.3s ease-out;

  // Mobile: commencer au-dessus du footer
  @media (max-width: 767px) {
    bottom: 60px; // Espace pour le footer de la page
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }

    to {
      opacity: 1;
    }
  }

  // Animation de fermeture pour mobile
  @media (max-width: 767px) {
    &.closing {
      animation: fadeOut 0.3s ease-in forwards;
      pointer-events: none; // Désactiver les interactions pendant la fermeture
    }

    @keyframes fadeOut {
      from {
        opacity: 1;
      }

      to {
        opacity: 0;
      }
    }
  }
}

// Popup/Modal
.technique-filter-popup {
  background: var(--color-surface);
  border-radius: 16px;
  width: 100%;
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-lg);
  animation: slideUp var(--transition-normal) ease-out;
  border: 1px solid var(--color-border);
  max-height: 90vh;
  overflow: hidden; // Empêcher le contenu de déborder et forcer le scroll interne

  // Desktop: taille adaptée, centrée, hauteur maximale sans chevaucher bannière/footer
  // Bannière: logo 72px + padding ≈ 88px, Footer: padding + texte ≈ 60px, Marges: ~10px
  // Total à soustraire: ~158px avec marge de sécurité minimale pour maximiser la hauteur
  @media (min-width: 768px) {
    width: 90%;
    max-width: 90%;
    max-height: calc(100vh - 88px - 60px - 10px); // Bannière + Footer + Marges minimales
    height: calc(100vh - 88px - 60px - 10px);
    min-height: calc(100vh - 88px - 60px - 5px); // Force la hauteur minimale
  }

  @media (min-width: 1024px) {
    width: 90%;
    max-width: 90%;
    max-height: calc(100vh - 88px - 60px - 10px);
    height: calc(100vh - 88px - 60px - 10px);
    min-height: calc(100vh - 88px - 60px - 5px); // Force la hauteur minimale
  }

  @media (min-width: 1440px) {
    width: 90%;
    max-width: 90%;
    max-height: calc(100vh - 88px - 60px - 10px);
    height: calc(100vh - 88px - 60px - 10px);
    min-height: calc(100vh - 88px - 60px - 5px); // Force la hauteur minimale
  }

  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }

    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  &.mobile {
    max-width: 100vw;
    width: 100vw;
    max-height: calc(100vh - 80px - 60px); // Hauteur totale moins bannière (80px) et footer (60px)
    height: calc(100vh - 80px - 60px);
    border-radius: 16px 16px 0 0;
    position: fixed;
    left: 0;
    right: 0;
    animation: slideUpMobile 0.3s ease-out;

    @keyframes slideUpMobile {
      from {
        transform: translateY(100%);
      }

      to {
        transform: translateY(0);
      }
    }

    // Animation de fermeture pour mobile
    &.closing {
      animation: slideDownMobile 0.3s ease-in forwards;
      pointer-events: none; // Désactiver les interactions pendant la fermeture
    }

    @keyframes slideDownMobile {
      from {
        transform: translateY(0);
      }

      to {
        transform: translateY(100%);
      }
    }
  }

  .technique-filter-popup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-xs) var(--spacing-lg);
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
    flex-shrink: 0; // Ne pas rétrécir, hauteur fixe
    flex-grow: 0; // Ne pas grandir, hauteur fixe
    border-radius: 16px 16px 0 0; // Arrondi en haut pour correspondre à la popup

    h2 {
      margin: 0;
      font-size: 1.1rem;
      font-weight: var(--font-weight-bold);
      color: var(--color-text-primary);
      font-family: var(--font-family-primary);
    }

    .close-button {
      background: none;
      border: none;
      cursor: pointer;
      padding: var(--spacing-xs);
      color: var(--color-text-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      transition: all var(--transition-normal);

      &:hover {
        background: var(--color-background);
        color: var(--color-accent);
      }

      svg {
        width: 24px;
        height: 24px;
        stroke: currentColor;
      }
    }
  }

  // S'assurer que app-technique-filter prend toute la hauteur disponible
  app-technique-filter {
    display: block;
    flex: 1 1 0%; // Prend tout l'espace restant après le header
    min-height: 0; // Permet au flex de fonctionner correctement
    overflow: hidden; // Empêcher le débordement
  }
}